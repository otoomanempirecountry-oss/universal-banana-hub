-- [[ üçå BANANA LIB V8 - GLASSMORPHISM & ANIMATED ]] --
local BananaLib = {}
local UserInputService = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")
local RunService = game:GetService("RunService")
local LP = game:GetService("Players").LocalPlayer
local Mouse = LP:GetMouse()

function BananaLib:CreateWindow(Config)
    local HubName = Config.Name or "BANANA HUB"
    local ImageID = Config.BackgroundImage or "rbxassetid://15286469273" -- Domy≈õlne t≈Ço bananowe
    
    local UI = Instance.new("ScreenGui", game:GetService("CoreGui"))
    UI.Name = "BananaLib_V8"

    -- G≈Å√ìWNE OKNO (Zaczyna jako ma≈Çe i przezroczyste do animacji)
    local Main = Instance.new("Frame", UI)
    Main.Size = UDim2.new(0, 0, 0, 0)
    Main.Position = UDim2.new(0.5, 0, 0.5, 0)
    Main.BackgroundColor3 = Color3.fromRGB(15, 15, 15)
    Main.BackgroundTransparency = 1
    Main.BorderSizePixel = 0
    Main.ClipsDescendants = true
    Instance.new("UICorner", Main).CornerRadius = UDim.new(0, 12)

    -- EFEKT CIENIA / PO≈öWIATY
    local Shadow = Instance.new("ImageLabel", UI)
    Shadow.Size = UDim2.new(0, 0, 0, 0)
    Shadow.Position = UDim2.new(0.5, 0, 0.5, 0)
    Shadow.BackgroundTransparency = 1
    Shadow.Image = "rbxassetid://6015667343"
    Shadow.ImageColor3 = Color3.fromRGB(0, 0, 0)
    Shadow.ImageTransparency = 1
    Shadow.ZIndex = 0

    -- T≈ÅO (Obrazek z efektem przyciemnienia)
    local BG = Instance.new("ImageLabel", Main)
    BG.Size = UDim2.new(1, 0, 1, 0)
    BG.Image = ImageID
    BG.ImageTransparency = 1
    BG.ScaleType = Enum.ScaleType.Crop
    Instance.new("UICorner", BG).CornerRadius = UDim.new(0, 12)
    
    local Overlay = Instance.new("Frame", Main)
    Overlay.Size = UDim2.new(1, 0, 1, 0)
    Overlay.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
    Overlay.BackgroundTransparency = 1

    -- ANIMACJA WEJ≈öCIA (Otwieranie)
    task.spawn(function()
        TweenService:Create(Main, TweenInfo.new(0.6, Enum.EasingStyle.Back, Enum.EasingDirection.Out), {
            Size = UDim2.new(0, 580, 0, 380),
            Position = UDim2.new(0.5, -290, 0.5, -190),
            BackgroundTransparency = 0.1
        }):Play()
        TweenService:Create(Shadow, TweenInfo.new(0.6, Enum.EasingStyle.Quart, Enum.EasingDirection.Out), {
            Size = UDim2.new(0, 620, 0, 420),
            Position = UDim2.new(0.5, -310, 0.5, -210),
            ImageTransparency = 0.5
        }):Play()
        TweenService:Create(BG, TweenInfo.new(1, Enum.EasingStyle.Quart), {ImageTransparency = 0.4}):Play()
        TweenService:Create(Overlay, TweenInfo.new(1, Enum.EasingStyle.Quart), {BackgroundTransparency = 0.5}):Play()
    end)

    -- SIDEBAR (Transparent Acrylic Style)
    local Sidebar = Instance.new("Frame", Main)
    Sidebar.Size = UDim2.new(0, 150, 1, 0)
    Sidebar.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
    Sidebar.BackgroundTransparency = 0.7
    Sidebar.BorderSizePixel = 0
    Instance.new("UICorner", Sidebar).CornerRadius = UDim.new(0, 12)

    local Title = Instance.new("TextLabel", Sidebar)
    Title.Text = HubName
    Title.Size = UDim2.new(1, 0, 0, 60)
    Title.Font = Enum.Font.GothamBold
    Title.TextColor3 = Color3.fromRGB(255, 215, 0)
    Title.TextSize = 18
    Title.BackgroundTransparency = 1

    local TabScroll = Instance.new("ScrollingFrame", Sidebar)
    TabScroll.Size = UDim2.new(1, 0, 1, -70)
    TabScroll.Position = UDim2.new(0, 0, 0, 65)
    TabScroll.BackgroundTransparency = 1
    TabScroll.ScrollBarThickness = 0
    local TabList = Instance.new("UIListLayout", TabScroll)
    TabList.Padding = UDim.new(0, 5)
    TabList.HorizontalAlignment = Enum.HorizontalAlignment.Center

    local Container = Instance.new("Frame", Main)
    Container.Size = UDim2.new(1, -165, 1, -20)
    Container.Position = UDim2.new(0, 160, 0, 10)
    Container.BackgroundTransparency = 1

    -- SMOOTH DRAG
    local dragging, dragInput, dragStart, startPos
    Main.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            dragging = true; dragStart = input.Position; startPos = Main.Position
        end
    end)
    UserInputService.InputChanged:Connect(function(input)
        if dragging and input.UserInputType == Enum.UserInputType.MouseMovement then
            local delta = input.Position - dragStart
            TweenService:Create(Main, TweenInfo.new(0.12), {Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)}):Play()
            TweenService:Create(Shadow, TweenInfo.new(0.12), {Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X - 20, startPos.Y.Scale, startPos.Y.Offset + delta.Y - 20)}):Play()
        end
    end)
    Main.InputEnded:Connect(function(input) if input.UserInputType == Enum.UserInputType.MouseButton1 then dragging = false end end)

    local Tabs = {Active = nil}
    function Tabs:CreateTab(Name)
        local Page = Instance.new("ScrollingFrame", Container)
        Page.Size = UDim2.new(1, 0, 1, 0)
        Page.BackgroundTransparency = 1
        Page.Visible = false
        Page.ScrollBarThickness = 2
        Page.ScrollBarImageColor3 = Color3.fromRGB(255, 215, 0)
        Instance.new("UIListLayout", Page).Padding = UDim.new(0, 8)

        local TBtn = Instance.new("TextButton", TabScroll)
        TBtn.Size = UDim2.new(0.9, 0, 0, 35)
        TBtn.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
        TBtn.BackgroundTransparency = 1
        TBtn.Text = Name
        TBtn.TextColor3 = Color3.fromRGB(180, 180, 180)
        TBtn.Font = Enum.Font.Gotham
        TBtn.TextSize = 13
        Instance.new("UICorner", TBtn).CornerRadius = UDim.new(0, 6)

        TBtn.MouseButton1Click:Connect(function()
            for _, v in pairs(Container:GetChildren()) do v.Visible = false end
            for _, v in pairs(TabScroll:GetChildren()) do if v:IsA("TextButton") then 
                TweenService:Create(v, TweenInfo.new(0.3), {BackgroundTransparency = 1, TextColor3 = Color3.fromRGB(180, 180, 180)}):Play()
            end end
            Page.Visible = true
            TweenService:Create(TBtn, TweenInfo.new(0.3), {BackgroundTransparency = 0.9, TextColor3 = Color3.fromRGB(255, 215, 0)}):Play()
        end)

        if not Tabs.Active then
            Tabs.Active = true
            Page.Visible = true
            TBtn.BackgroundTransparency = 0.9
            TBtn.TextColor3 = Color3.fromRGB(255, 215, 0)
        end

        local Elements = {}

        -- BUTTON (Modern Glass)
        function Elements:CreateButton(Text, Callback)
            local B = Instance.new("TextButton", Page)
            B.Size = UDim2.new(0.96, 0, 0, 38)
            B.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
            B.BackgroundTransparency = 0.6
            B.Text = "  " .. Text
            B.TextColor3 = Color3.fromRGB(255, 255, 255)
            B.Font = Enum.Font.Gotham
            B.TextSize = 13
            B.TextXAlignment = Enum.TextXAlignment.Left
            Instance.new("UICorner", B).CornerRadius = UDim.new(0, 8)
            local Stroke = Instance.new("UIStroke", B)
            Stroke.Color = Color3.fromRGB(255, 255, 255); Stroke.Transparency = 0.9

            B.MouseButton1Click:Connect(function()
                local Circle = Instance.new("Frame", B) -- Effect
                Circle.Size = UDim2.new(0,0,0,0); Circle.Position = UDim2.new(0.5,0,0.5,0); Circle.BackgroundColor3 = Color3.fromRGB(255,215,0); Circle.BackgroundTransparency = 0.5; Instance.new("UICorner", Circle).CornerRadius = UDim.new(1,0)
                TweenService:Create(Circle, TweenInfo.new(0.4), {Size = UDim2.new(1,0,2,0), Position = UDim2.new(0,-20,-0.5,0), BackgroundTransparency = 1}):Play()
                Callback()
                task.wait(0.4); Circle:Destroy()
            end)
        end

        -- SLIDER (Slim & Pro)
        function Elements:CreateSlider(Name, Min, Max, Start, Callback)
            local S = Instance.new("Frame", Page)
            S.Size = UDim2.new(0.96, 0, 0, 48)
            S.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
            S.BackgroundTransparency = 0.6
            Instance.new("UICorner", S).CornerRadius = UDim.new(0, 8)

            local T = Instance.new("TextLabel", S)
            T.Text = "  "..Name; T.Size = UDim2.new(1,0,0,28); T.TextColor3 = Color3.fromRGB(200,200,200); T.Font = Enum.Font.Gotham; T.TextSize = 12; T.BackgroundTransparency = 1; T.TextXAlignment = Enum.TextXAlignment.Left

            local V = Instance.new("TextLabel", S)
            V.Text = tostring(Start); V.Position = UDim2.new(1,-50,0,0); V.Size = UDim2.new(0,40,0,28); V.TextColor3 = Color3.fromRGB(255,215,0); V.Font = Enum.Font.GothamBold; V.TextSize = 12; V.BackgroundTransparency = 1

            local Bar = Instance.new("Frame", S)
            Bar.Size = UDim2.new(0.9, 0, 0, 4); Bar.Position = UDim2.new(0.05, 0, 0.75, 0); Bar.BackgroundColor3 = Color3.fromRGB(60,60,60); Instance.new("UICorner", Bar)

            local Fill = Instance.new("Frame", Bar)
            Fill.Size = UDim2.new((Start-Min)/(Max-Min), 0, 1, 0); Fill.BackgroundColor3 = Color3.fromRGB(255,215,0); Instance.new("UICorner", Fill)

            local function Update()
                local P = math.clamp((Mouse.X - Bar.AbsolutePosition.X) / Bar.AbsoluteSize.X, 0, 1)
                local Val = math.floor(Min + (Max-Min) * P)
                Fill.Size = UDim2.new(P, 0, 1, 0)
                V.Text = tostring(Val)
                Callback(Val)
            end

            Bar.InputBegan:Connect(function(i) if i.UserInputType == Enum.UserInputType.MouseButton1 then
                local Move; Move = RunService.RenderStepped:Connect(Update)
                UserInputService.InputEnded:Connect(function(i2) if i2.UserInputType == Enum.UserInputType.MouseButton1 then Move:Disconnect() end end)
            end end)
        end

        return Elements
    end
    return Tabs
end

return BananaLib
